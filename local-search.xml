<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title></title>
    <link href="/2025/02/21/%E5%8E%9F%E5%AD%90%E6%95%B0%E5%A4%A7%E4%BA%8E100%E7%9A%84%E5%A4%8D%E6%9D%82%E4%B8%8D%E5%AF%B9%E7%A7%B0%E6%9C%89%E6%9C%BA%E9%87%91%E5%B1%9E%E5%82%AC%E5%8C%96%E5%8F%8D%E5%BA%94%E7%9A%84%E8%BF%87%E6%B8%A1%E6%80%81%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95/"/>
    <url>/2025/02/21/%E5%8E%9F%E5%AD%90%E6%95%B0%E5%A4%A7%E4%BA%8E100%E7%9A%84%E5%A4%8D%E6%9D%82%E4%B8%8D%E5%AF%B9%E7%A7%B0%E6%9C%89%E6%9C%BA%E9%87%91%E5%B1%9E%E5%82%AC%E5%8C%96%E5%8F%8D%E5%BA%94%E7%9A%84%E8%BF%87%E6%B8%A1%E6%80%81%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="原子数大于100的复杂不对称有机金属催化反应的过渡态优化方法"><a href="#原子数大于100的复杂不对称有机金属催化反应的过渡态优化方法" class="headerlink" title="原子数大于100的复杂不对称有机金属催化反应的过渡态优化方法"></a>原子数大于100的复杂不对称有机金属催化反应的过渡态优化方法</h1><h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><ul><li>如果提前已知反应机理：了解反应机理和反应的实验条件（反应温度、溶剂、压力）；</li><li>未知反应机理：根据猜测分析反应机理，并制定计算分析计划，分步搜索过渡态，最终绘制reaction profile；</li><li>确定过渡态结构优化&#x2F;频率分析和电子能量计算两步骤的泛函，基组&#x2F;赝势基组，色散校正项。</li></ul><h2 id="计算流程"><a href="#计算流程" class="headerlink" title="计算流程"></a>计算流程</h2><ol><li><p>手动建立反应络合体系的过渡态初猜结构；</p></li><li><p>采用Gaussian+GFN2-xTB快速搜索过渡态初猜结构；</p></li><li><p>利用GENConf-TS固定反应位点，基于分子动力学方法，指定温度进行最低能量构象搜索；</p><ul><li><a href="http://bbs.keinsci.com/thread-20063-1-1.html">http://bbs.keinsci.com/thread-20063-1-1.html</a></li><li><a href="http://sobereva.com/165">根据Boltzmann分布计算分子不同构象所占比例</a>：<a href="http://sobereva.com/165">http://sobereva.com/165</a></li><li><a href="http://bbs.keinsci.com/thread-577-1-1.html">http://bbs.keinsci.com/thread-577-1-1.html</a></li><li><a href="http://bbs.keinsci.com/forum.php?mod=viewthread&tid=2388&highlight=gentor">http://bbs.keinsci.com/forum.php?mod=viewthread&amp;tid=2388&amp;highlight=gentor</a></li></ul></li><li><p>基于最低能量构象，重新创建Gaussian的输入文件。对于较大体系，过渡态优化的计算指令可按照如下方式渐进，在有限计算资源下最快找到DFT精度级别的可用过渡态结构：</p><ul><li><p>首先用opt&#x3D;(ts,noeigen,calcfc,recalc&#x3D;3)，或者recalc&#x3D;5成本更低一些；</p></li><li><p>如果不收敛，可尝试opt&#x3D;(ts,noeigen,calcfc,recalc&#x3D;3,maxstep&#x3D;3,notrust)，这样基本大部分都能成功；</p></li><li><p>再进一步，采用opt&#x3D;(ts,noeigen,calcall)，每一步都精确计算Hessian，计算成本最高，但是能够保证不会陷入优化振荡。</p></li><li><p>优化指令的技术解释：</p><p>一般采用的计算精度级别越高，势能面越精确，因此直接采用calcfc命令计算由于Hessian只在第一步计算了精确值，大体系优化到后期容易陷入优化振荡，也就是从optimization中可以看到体系的能量一开始是下降的，但后面优化到两百步以上基本就在反复振荡，难以收敛到精确的鞍点（一般正常收敛150个原子体系需要100+步优化就成功了，步骤更多的基本就是陷入振荡了）。</p><p>这时候，需要采用recalc命令结合calcfc使用，每走n步就重新计算精确Hessian，并结合maxstep调整每一次优化的步长上限来走出势阱。</p><p><em>opt&#x3D;maxstep&#x3D;N（等价于IOp(1&#x2F;8&#x3D;N)）可以将步长上限（也称置信半径）调整到0.01N Bohr或弧度，默认是30。当按照优化方法判断出的下一步几何变量的变化超过这个数值，则实际的改变量会调节到恰好等于这个上限值（具体来说，是在置信半径对应的球面上做最小化寻找最佳的位置）。如果优化发生震荡，且每步位移不是很大而受力较大的话，往往表明优化过程陷在比较深、比较窄的势阱里，此时可以降低步长上限，比如降低到N&#x3D;5乃至N&#x3D;3，以避免每次都走过头而始终达不到势能面极小点。减小步长的做法不要在优化过程中过早地使用，否则由于优化过程走得太慢，所需的优化步数会增加。另外，如果用了calcall，减小步长上限不一定有好处，因为在精确Hessian下进行优化，每一步走的是比较准确的，人为篡改了步长有可能还阻碍收敛。</em></p><p><em>注意，maxstep设的只是最初的步长上限。随着优化的进行，步长上限其实是动态调整的。如果想一直用自己的设定，需要在opt中加上NoTrust关键词。对于结构反复微小震荡的情况，在使用maxstep减小步长上限的同时总建议同时写上此关键词。</em>*</p><p><em>（<a href="http://sobereva.com/164%EF%BC%89">http://sobereva.com/164）</a></em></p></li></ul></li><li><p>限制性优化技巧</p><ul><li>对于GENConf-TS得到的最低能量构象，或者是之前优化未收敛的几何结构，可以提取出来，固定其过渡态反应位点，进行限制性几何结构最小化，最后将最小化结构作为过渡态初猜来用于过渡态的精确搜索。固定反应位点可以采用Gaussview手动操作，教程<a href="http://bbs.keinsci.com/thread-9022-1-1.html%E3%80%82%E5%8F%B3%E9%94%AE%E7%82%B9%E5%87%BB%E9%9C%80%E8%A6%81%E5%86%BB%E7%BB%93%E7%9A%84%E5%8E%9F%E5%AD%90%EF%BC%8C%E9%80%89%E6%8B%A9select%EF%BC%8C%E5%8E%9F%E5%AD%90%E5%8F%98%E4%B8%BA%E9%BB%84%E8%89%B2%EF%BC%8C%E9%80%89%E5%AE%8C%E4%BA%86%E4%B9%8B%E5%90%8E%EF%BC%8C%E8%BF%9B%E5%85%A5Tools">http://bbs.keinsci.com/thread-9022-1-1.html。右键点击需要冻结的原子，选择select，原子变为黄色，选完了之后，进入Tools</a> - Atom Groups，把类别切换到Freeze，然后点击Freeze(Yes)那一行中的+号把选中的区域添加到这个冻结组里。此时体系就被分为冻结和不冻结的两个组了。保存之后发现被冻结的原子会在多出的一列数值中显示为-1，未被冻结的显示为0。</li><li>注意最后限制性优化完成后，复制坐标到TS优化任务的输入文件中要记得取消反应位点冻结。</li></ul></li><li><p>色散校正</p><ul><li><a href="http://sobereva.com/210">http://sobereva.com/210</a></li><li>em&#x3D;gd3bj和em&#x3D;gd3要分开看，有些基组有BJ阻尼的就不要加上bj的关键词。</li></ul></li><li><p>赝势基组</p><ul><li><a href="http://sobereva.com/373">http://sobereva.com/373</a></li></ul></li><li><p>溶剂化模型</p><ul><li><a href="http://sobereva.com/327">http://sobereva.com/327</a></li></ul></li></ol>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2025/02/21/Q2MM(TSFF)%E6%96%B9%E6%B3%95%E7%9A%84%E7%BB%86%E8%8A%82%E4%B8%8E%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/"/>
    <url>/2025/02/21/Q2MM(TSFF)%E6%96%B9%E6%B3%95%E7%9A%84%E7%BB%86%E8%8A%82%E4%B8%8E%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="Q2MM-TSFF-方法的细节与实现原理"><a href="#Q2MM-TSFF-方法的细节与实现原理" class="headerlink" title="Q2MM(TSFF)方法的细节与实现原理"></a>Q2MM(TSFF)方法的细节与实现原理</h1><p>TSFF力场由来已久，早期的科研人员通过传统的分子力场方法直接应用到反应过渡态的方式进行反应动力学研究。Q2MM是一种经过Per-Ola Norrby课题组经过长达二十多年开发形成的全新具有高度实用价值的过渡态力场方法，目前已经被集成到ACE（Asymmetric catalytic evaluation）和CatVS（Catalyst virtual screening）这两个全自动化均相催化剂虚拟筛选软件之中，相关论文发表于Nat. Catalysis，JACS，JCC，Chem. Sci. 等期刊。</p><p>![1c07abea3fa047817db72a78c606ade](E:\Softwares\WeChat\WeChat Files\wxid_mw2n7uz79zg222\FileStorage\Temp\1c07abea3fa047817db72a78c606ade.png)</p><p>TSFF（过渡态力场，Transition State Force Field）方法是专门为准确预测化学反应中的过渡态能量而开发的。传统的力场方法（如分子力学）主要用于预测分子在平衡状态下的几何结构和相对稳定的构象转变。然而，传统力场通常不适用于反应中的键断裂或形成过程，因为这些过程涉及显著的几何变形和势能面的复杂变化。</p><p>TSFF方法的核心创新在于，将过渡态视为势能面的局部极小值，并通过重新构建力场参数，使得过渡态几何结构可以通过最小化能量直接获得(2003_TSFF过渡态力场的原理)。与常规力场方法不同，TSFF不依赖反应物和产物的势能面，而是直接将过渡态的几何信息融入力场中。这种方法不仅能够有效捕捉过渡态的能量，还能准确预测类似反应的相对反应性和选择性。</p><h2 id="TSFF的原理"><a href="#TSFF的原理" class="headerlink" title="TSFF的原理"></a>TSFF的原理</h2><h3 id="力场参数的回归流程"><a href="#力场参数的回归流程" class="headerlink" title="力场参数的回归流程"></a>力场参数的回归流程</h3><p><img src="C:\Users\TangKun\AppData\Roaming\Typora\typora-user-images\image-20241030101850260.png" alt="image-20241030101850260"></p><h3 id="过渡态结构优化上的巧思"><a href="#过渡态结构优化上的巧思" class="headerlink" title="过渡态结构优化上的巧思"></a>过渡态结构优化上的巧思</h3><p>TSFF拟合需要QM计算得到的精确过渡态的结构以及其对应的Hessian矩阵，这里对标签值中的Hessian矩阵进行了修改，将Hessian矩阵对角化之后得到的特征值中的唯一的负值改成了+1（一个相对较大的正特征值），这样做会使得过渡态沿着反应路径（MEP）的势能面的曲率反转变成正值，从可视化角度看就是势能面进行了翻转，如下图所示，原先过渡态上的鞍点变成了极小点，这样操作之后，就可以采用最小化优化算法来优化过渡态结构了。</p><p><img src="C:\Users\TangKun\AppData\Roaming\Typora\typora-user-images\image-20241030102428789.png" alt="image-20241030102428789"></p><!--补充知识1：E对R求二阶偏导数得到维度为(3*N，3*N)的Hessian矩阵，Hessian中的每一个元素都是关于两个不同原子坐标的能量的导数，其中对角元素是每个原子自身坐标关于能量的二阶偏导数，因此在使用Hessian时一般只需要上或者下三角阵即可包含全部所需的信息--><!--补充知识2：Hessian对角化操作可以求出特征值和特征向量，特征值对应分子系统中原子与原子之间的振动频率，特征向量对应振动方向及振幅 。特征值全部为正代表曲率为正，坐标不论怎么改变，不论向着什么方向，能量都会升高，这对应着势能面上的谷底（极小点）；特征值除了反应坐标方向为负值（曲率为负值，也是唯一的虚频的来源，参见下面的公式），其余都为正，这对应着过渡态，也就是势能面上的鞍点，因为这个点上的结构只有沿着反应坐标变化能量才会降低，而其他所有方向都会升高--><!--振动频率ω可以通过下面的公式计算，其中λ是特征值，μ是约化质量。--><p>$$<br>\omega&#x3D;\sqrt{\frac{1}{\mu}\lambda}<br>$$</p><h3 id="Hessian标签数据处理方式"><a href="#Hessian标签数据处理方式" class="headerlink" title="Hessian标签数据处理方式"></a>Hessian标签数据处理方式</h3><ul><li><p>首先通过QM做频率分析计算得到Hessian矩阵</p></li><li><p>对Hessian矩阵进行对角化得到特征值特征向量</p></li><li><p>将唯一的负特征值改为(+1)</p></li><li><p>根据修改之后的特征向量和特征值还原出新的Hessian</p></li><li><p>以新的Hessian拟合力场参数<br>$$<br>H&#x3D;X^TDX<br>$$</p><p>$$<br>\mathsf{H}^{\prime}&#x3D;\mathbf{X}^{\mathsf{T}}\mathbf{D}^{\prime}\mathbf{X}<br>$$</p><p>$$<br>\mathbf{D}&#x3D;\begin{bmatrix}-\lambda_1&amp;&amp;\cdots&amp;&amp;\mathbf{0}\\&amp;\mathbf{0}&amp;&amp;&amp;\\\vdots&amp;&amp;\lambda_\mathbf{8}&amp;&amp;\vdots\\&amp;&amp;&amp;\ddots&amp;\\\mathbf{0}&amp;\cdots&amp;&amp;&amp;\lambda_N\end{bmatrix}\quad\mathbf{D}^{\prime}&#x3D;\begin{bmatrix}+\mathbf{1}&amp;&amp;\cdots&amp;&amp;\mathbf{0}\\&amp;\mathbf{0}&amp;&amp;&amp;\\\vdots&amp;&amp;\lambda_\mathbf{\Phi}&amp;&amp;\vdots\\&amp;&amp;&amp;\ddots&amp;\\\mathbf{0}&amp;\cdots&amp;&amp;&amp;\lambda_N\end{bmatrix}<br>$$</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-comment"># 对角化Hessian矩阵</span><br>eigenvalues, eigenvectors = np.linalg.eig(hessian_matrix)<br></code></pre></td></tr></table></figure><h2 id="TSFF的发展以及拟合的注意事项"><a href="#TSFF的发展以及拟合的注意事项" class="headerlink" title="TSFF的发展以及拟合的注意事项"></a>TSFF的发展以及拟合的注意事项</h2><h3 id="关于Hessian的拟合"><a href="#关于Hessian的拟合" class="headerlink" title="关于Hessian的拟合"></a>关于Hessian的拟合</h3><p>TSFF拟合过程中惩罚函数是预测值与标签值之间的平方误差之和，最开始的工作中为了区分分别与键角、扭转、长程作用相关的Hessian元素，对惩罚函数中的平方误差和采用了加权因子缩放[Hagler and coworkers]。后续的更新版本TSFF去掉了加权因子缩放操作，直接拟合原始Hessian。</p><p>连接同一原子上两个坐标的Hessian元素，块对角元素，并不直接对应于力场相互作用，而是包含冗余数据。块对角线元素是非对角线元素的总和，并且倾向于将适当拟合的Hessian元素与可用分子力学函数无法表示的其他元素耦合。因此，通过从参数化过程中排除块对角元素，可以在不损失数据的情况下改进Hessian拟合，称之为“非对角线Hessian拟合”。</p><h2 id="如何采用NFF取代TSFF"><a href="#如何采用NFF取代TSFF" class="headerlink" title="如何采用NFF取代TSFF"></a>如何采用NFF取代TSFF</h2><h2 id="NFF取代TSFF进行催化剂虚拟筛选的尝试"><a href="#NFF取代TSFF进行催化剂虚拟筛选的尝试" class="headerlink" title="NFF取代TSFF进行催化剂虚拟筛选的尝试"></a>NFF取代TSFF进行催化剂虚拟筛选的尝试</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/02/21/hello-world/"/>
    <url>/2025/02/21/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
